{% extends "base.html" %}
{% load static wagtailcore_tags wagtailimages_tags %}

{% block title %}{{ page_title }} - {{ block.super }}{% endblock %}

{% block meta_description %}{{ page_description }}{% endblock %}

{% block body_class %}categories-page{% endblock %}

{% block content %}
<div class="container">
    <!-- Page Header -->
    <header class="page-header" style="text-align: center; padding: 4rem 0; margin-bottom: 3rem;">
        <h1 style="font-family: var(--font-display); font-size: var(--font-size-5xl); font-weight: 700; margin-bottom: 1rem; color: var(--color-gray-900);">
            {{ page_title }}
        </h1>
        <p style="font-size: var(--font-size-lg); color: var(--color-gray-600); max-width: 600px; margin: 0 auto 2rem;">
            {{ page_description }}
        </p>
        
        <div class="stats-grid" style="display: flex; justify-content: center; gap: 3rem; margin-top: 2rem;">
            <div class="stat-item" style="text-align: center;">
                <div style="font-size: var(--font-size-3xl); font-weight: 700; color: var(--color-primary); margin-bottom: 0.5rem;">
                    {{ total_categories }}
                </div>
                <div style="font-size: var(--font-size-sm); color: var(--color-gray-500); font-weight: 500;">
                    Categories
                </div>
            </div>
            <div class="stat-item" style="text-align: center;">
                <div style="font-size: var(--font-size-3xl); font-weight: 700; color: var(--color-primary); margin-bottom: 0.5rem;">
                    {{ total_articles }}
                </div>
                <div style="font-size: var(--font-size-sm); color: var(--color-gray-500); font-weight: 500;">
                    Articles
                </div>
            </div>
        </div>
    </header>

    <!-- Categories Grid -->
    <section class="categories-section">
        {% if categories_data %}
        <div class="categories-grid" style="display: grid; grid-template-columns: repeat(auto-fit, minmax(350px, 1fr)); gap: 2rem; margin-bottom: 3rem;">
            {% for item in categories_data %}
            {% with category=item.category recent_articles=item.recent_articles %}
            <article class="category-card" style="background: white; border-radius: var(--radius-2xl); overflow: hidden; box-shadow: var(--shadow-lg); transition: all var(--transition-normal); border: 1px solid var(--color-gray-100);">
                <!-- Category Header -->
                <div class="category-header" style="background: linear-gradient(135deg, {{ category.color|default:'var(--color-primary)' }}, {{ category.color|default:'var(--color-primary)' }}dd); padding: 2rem; color: white; position: relative;">
                    <div style="position: absolute; top: 0; right: 0; padding: 1rem; opacity: 0.1; font-size: 4rem;">
                        {{ category.name|first|upper }}
                    </div>
                    <h2 style="font-family: var(--font-display); font-size: var(--font-size-2xl); font-weight: 600; margin-bottom: 0.5rem; position: relative; z-index: 2;">
                        {{ category.name }}
                    </h2>
                    {% if category.description %}
                    <p style="opacity: 0.9; line-height: var(--leading-relaxed); margin-bottom: 1rem; position: relative; z-index: 2;">
                        {{ category.description|truncatewords:20 }}
                    </p>
                    {% endif %}
                    <div class="category-stats" style="display: flex; align-items: center; gap: 1rem; font-size: var(--font-size-sm); opacity: 0.9; position: relative; z-index: 2;">
                        <span>üìÑ {{ category.article_count }} article{{ category.article_count|pluralize }}</span>
                    </div>
                </div>

                <!-- Recent Articles -->
                {% if recent_articles %}
                <div class="recent-articles" style="padding: 1.5rem;">
                    <h3 style="font-size: var(--font-size-base); font-weight: 600; margin-bottom: 1rem; color: var(--color-gray-800);">
                        Recent Articles
                    </h3>
                    <div class="articles-list" style="display: flex; flex-direction: column; gap: 0.75rem;">
                        {% for article in recent_articles %}
                        <a href="{{ article.get_url }}" class="article-item" style="display: flex; gap: 0.75rem; text-decoration: none; color: inherit; padding: 0.5rem; border-radius: var(--radius); transition: all var(--transition-fast);">
                            {% if article.featured_image %}
                            <div style="width: 50px; height: 35px; border-radius: var(--radius); overflow: hidden; flex-shrink: 0; background: var(--color-gray-200);">
                                {% image article.featured_image width-100 height-70 as thumb %}
                                <img src="{{ thumb.url }}" alt="{{ article.title }}" style="width: 100%; height: 100%; object-fit: cover;">
                            </div>
                            {% endif %}
                            <div style="flex: 1; min-width: 0;">
                                <h4 style="font-size: var(--font-size-sm); font-weight: 500; margin: 0 0 0.25rem 0; color: var(--color-gray-900); line-height: var(--leading-tight);">
                                    {{ article.title|truncatechars:50 }}
                                </h4>
                                <div style="font-size: var(--font-size-xs); color: var(--color-gray-500);">
                                    {{ article.first_published_at|date:"M d" }} ‚Ä¢ {{ article.reading_time_minutes }} min
                                </div>
                            </div>
                        </a>
                        {% endfor %}
                    </div>
                </div>
                {% endif %}

                <!-- Category Footer -->
                <div class="category-footer" style="padding: 1.5rem; border-top: 1px solid var(--color-gray-100); background: var(--color-gray-50);">
                    <a href="{% url 'blog:category_detail' category_slug=category.slug %}" class="category-btn" style="display: inline-flex; align-items: center; gap: 0.5rem; background: {{ category.color|default:'var(--color-primary)' }}; color: white; padding: 0.75rem 1.5rem; border-radius: var(--radius-full); text-decoration: none; font-weight: 600; font-size: var(--font-size-sm); transition: all var(--transition-fast);">
                        Explore {{ category.name }}
                        <svg style="width: 16px; height: 16px;" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M9 5l7 7-7 7"></path>
                        </svg>
                    </a>
                </div>
            </article>
            {% endwith %}
            {% endfor %}
        </div>
        {% else %}
        <div class="no-categories" style="text-align: center; padding: 4rem; color: var(--color-gray-500);">
            <div style="font-size: 4rem; margin-bottom: 1rem;">üìÅ</div>
            <h2 style="font-size: var(--font-size-2xl); font-weight: 600; margin-bottom: 1rem; color: var(--color-gray-700);">
                No Categories Available
            </h2>
            <p style="font-size: var(--font-size-lg); margin-bottom: 2rem;">
                Categories will appear here as articles are published.
            </p>
            <a href="/blog/" class="btn btn-primary" style="display: inline-flex; align-items: center; gap: 0.5rem;">
                Browse All Articles
                <svg style="width: 16px; height: 16px;" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                    <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M9 5l7 7-7 7"></path>
                </svg>
            </a>
        </div>
        {% endif %}
    </section>

    <!-- Call to Action -->
    <section class="cta-section" style="background: linear-gradient(135deg, var(--color-primary), var(--color-primary-dark)); color: white; padding: 3rem; border-radius: var(--radius-2xl); text-align: center; margin-top: 4rem;">
        <h2 style="font-family: var(--font-display); font-size: var(--font-size-3xl); font-weight: 600; margin-bottom: 1rem;">
            Can't Find What You're Looking For?
        </h2>
        <p style="font-size: var(--font-size-lg); opacity: 0.9; margin-bottom: 2rem; max-width: 600px; margin-left: auto; margin-right: auto;">
            Browse all our articles or use the search function to find specific topics.
        </p>
        <div style="display: flex; justify-content: center; gap: 1rem; flex-wrap: wrap;">
            <a href="/blog/" class="cta-btn" style="background: white; color: var(--color-primary); padding: 0.75rem 2rem; border-radius: var(--radius-full); text-decoration: none; font-weight: 600; transition: all var(--transition-fast); display: inline-flex; align-items: center; gap: 0.5rem;">
                Browse All Articles
                <svg style="width: 16px; height: 16px;" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                    <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M9 5l7 7-7 7"></path>
                </svg>
            </a>
            <button onclick="document.querySelector('.search-input').focus()" class="cta-btn" style="background: rgba(255, 255, 255, 0.2); color: white; border: 2px solid rgba(255, 255, 255, 0.3); padding: 0.75rem 2rem; border-radius: var(--radius-full); font-weight: 600; cursor: pointer; transition: all var(--transition-fast); display: inline-flex; align-items: center; gap: 0.5rem;">
                Search Articles
                <svg style="width: 16px; height: 16px;" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                    <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M21 21l-6-6m2-5a7 7 0 11-14 0 7 7 0 0114 0z"></path>
                </svg>
            </button>
        </div>
    </section>
</div>

<style>
.category-card:hover {
    transform: translateY(-8px);
    box-shadow: var(--shadow-2xl);
}

.category-btn:hover {
    transform: translateY(-2px);
    box-shadow: 0 10px 25px -5px rgba(0, 0, 0, 0.3);
}

.article-item:hover {
    background: var(--color-gray-50);
}

.article-item:hover h4 {
    color: var(--color-primary);
}

.cta-btn:hover {
    transform: translateY(-2px);
}

.cta-btn:first-child:hover {
    box-shadow: 0 10px 25px -5px rgba(0, 0, 0, 0.2);
}

.cta-btn:last-child:hover {
    background: rgba(255, 255, 255, 0.3);
    border-color: rgba(255, 255, 255, 0.5);
}

@media (max-width: 768px) {
    .categories-grid {
        grid-template-columns: 1fr !important;
        gap: 1.5rem !important;
    }
    
    .stats-grid {
        gap: 2rem !important;
    }
    
    .category-header {
        padding: 1.5rem !important;
    }
    
    .recent-articles {
        padding: 1rem !important;
    }
    
    .category-footer {
        padding: 1rem !important;
    }
}
</style>
{% endblock %}